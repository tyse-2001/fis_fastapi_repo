<!DOCTYPE html>
<html>
    <head>
        {% load static %}
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
        <link rel="stylesheet" type="text/css" href="{% static 'fastapi_table/style.css' %}">
    </head>
    <body>
        {% include "fastapi_table/page_header.html" %}
        <div class="main-body">
            <div class="page_name">
                <h2>Files page</h2>
            </div>
            <form action="/fastapi_table/files_get/" method="get">
                {% csrf_token %}
                {{ form }}
                <input type="submit" value="Submit">
            </form>
            <br>
            <h4 class="table-header">List of searched files:</h4>
            <table>
                <tr>
                    <th>file_id</th>
                    <th>file_name</th>
                    <th>file_date_scanned</th>
                    <th>score</th>
                    <th>severity</th>
                    <th>exec_parent_count</th>
                </tr>
                {% for entries in files_list %}
                    <tr class="{% if entries.severity == 'low' %}severity-low{% endif %}{% if entries.severity == 'medium' %}severity-medium{% endif %}{% if entries.severity == 'high' %}severity-high{% endif %}">
                        <td><a href="/fastapi_table/files/{{ entries.file_id }}">{{ entries.file_id }}</a></td>
                        <td>{{ entries.file_name }}</td>
                        <td>{{ entries.file_date_scanned }}</td>
                        <td>{{ entries.score }}</td>
                        <td>{{ entries.severity }}</td>
                        <td>{{ entries.exec_parent_count }}</td>
                    </tr>
                {% endfor %}
            </table>
        </div>
    </body>
</html>